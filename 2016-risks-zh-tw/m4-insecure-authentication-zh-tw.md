---

layout: col-sidebar
title: "M4: 不安全的身分驗證"
---

# 威脅主體

**應用層面 特定**

利用身份驗證漏洞的威脅主體通常會透過使用現有或自行建構的工具進行自動化攻擊。

# 攻擊媒介		

**利用難度 簡單**

一旦攻擊者了解身份驗證架構存在弱點，他們會透過向行動應用程式的後端伺服器提交服務請求，以模擬或規避身份驗證，並避免直接與行動應用程式互動。這個提交過程通常是透過裝置內的行動惡意軟體或攻擊者擁有的僵屍網路（botnets）完成的。

# 安全層面的強度

**普及性 常見** <br />
**偵測性 平均**

缺乏或缺少的身份驗證架構使攻擊者能夠在行動應用程式或行動應用程式使用的後端伺服器中匿名執行功能。由於行動裝置的輸入形式，行動應用程式使用較脆弱的身份驗證相當普遍。該形式極大程度上鼓勵使用4位數PIN碼的簡短密碼。

與傳統網頁身份驗證方案相比，行動應用程式的身份驗證要求可能會有很大不同，這是由於其可用性需求。

在傳統的網頁應用程式中，會預期用戶應該一直在線並實時與後端伺服器進行身份驗證。在他們的會話期間，有一個合理的預期是他們將持續訪問網際網路。

而在行動應用程式中，並不要求用戶在其會話期間一直保持在線。與傳統網頁連接相比，行動網際網路連接的可靠性或可預測性要低得多。因此，行動應用程式可能有離線驗證的需求。這種離線需求可能對開發人員在實施行動身份驗證時必須考慮的事項產生深遠的影響。

為了檢測不良的身份驗證架構，測試人員可以在行動應用程式處於“離線”模式時對其進行二進制攻擊。透過這種攻擊，測試人員將強制應用程式規避離線驗證，然後執行應該需要離線驗證的功能（有關二進制攻擊的更多信息，請參見M10）。同樣，測試人員應嘗試通過從行動應用程式功能的任何POST/GET請求中刪除任何會話令牌，匿名執行任何後端伺服器功能。

# 技術性影響	

**影響程度 嚴重**

不良身份驗證的技術影響在於該程式無法識別執行操作請求的使用者。因此，該程式將無法記錄或監管使用者活動，因為無法確定使用者的身份。這將導致無法檢測攻擊的來源、潛在被利用的性質，或者如何預防未來的攻擊。

身份驗證失敗可能會暴露底層的授權失敗。當身份驗證控制失效時，程式無法驗證使用者的身份。這個身份與使用者的角色和相關權限相關聯。如果攻擊者能夠匿名執行敏感功能，這表明底層程式碼並沒有去驗證發出操作請求的使用者的權限。因此，程式碼的匿名執行透漏了身份驗證和授權控制的失敗。

# 業務影響
	
**應用程式/業務 特定** 
		

不良身份驗證的業務影響通常至少會導致以下情況:

- 名望受損;
- 信息盜竊;
- 未經授權訪問數據。

# 我是否容易受到「不安全的身分驗證」的攻擊？

行動應用程式可能因為不安全身份驗證而遭受多種不同的方式:

- 如果行動應用程式能夠在不提供訪問令牌的情況下匿名執行後端 API 服務請求，該應用程式可能存在不安全的身份驗證;
- 如果行動應用程式在裝置上本地存儲任何密碼或共享機密，它很可能存在不安全的身份驗證;
- 如果行動應用程式使用弱密碼政策以簡化輸入密碼，它可能存在不安全的身份驗證;
- 如果行動應用程式使用類似 TouchID 的功能，它可能存在不安全的身份驗證。

# 如何防止「不安全的身分驗證」?

**避免弱點模型(weak pattern)**

避免使用下列不安全的行動應用程式認證模型:

- 如果您將網站應用程式移植到行動應用程式，請確保行動應用程式的身份驗證需求與網站應用程式的元件相符。在身份驗證時，不應該比網頁瀏覽器使用更少的驗證要素;
- 本地使用者身份驗證可能導致客戶端規避認證的漏洞。如果應用程式在本地儲存數據，駭客可能通過運行時操作或二進制修改在越獄的設備上規避身份驗證程序。如果離線身份驗證是一個迫切的業務需求，請參考有關防止針對行動應用程式的二進制攻擊的額外指南;
- 在可能的情況下，所有身份驗證請求應在伺服器端進行。在成功驗證後，再將應用程式數據將加載到行動裝置上，確保僅在成功驗證後才能使用應用程式數據;
- 如果需要客戶端數據存儲，應使用從用戶登錄憑證中衍生的加密金鑰對數據進行加密。然而，仍存在通過二進制攻擊解密數據的額外風險。 有關防止導致本地數據盜竊的二進制攻擊的進一步指導，請參閱 M9;
- “記住我”功能永遠不應該在裝置上儲存使用者的密碼;
- 行動應用程式在理想情況下應使用一個裝置特定的身份驗證令牌，該令牌可以由用戶在應用程式中撤銷，以減輕由於設備丟失或被盜而導致的未經授權訪問風險;
- 避免使用可被偽造的數值進行用戶身份驗證，包括裝置辨識碼或地理位置;
- 行動應用程式中的持久身份驗證應該作為選項加以實施，而不是默認啟用;
- 在可能的情況下，應禁止用戶提供4位數的PIN碼作為身份驗證密碼。

**強化身分驗證**

- 開發人員應該假設所有客戶端的授權和身份驗證控制都可能被惡意使用者規避。對這些控制進行伺服器端強化至關重要。
- 由於離線使用的需求，行動應用程式可能需要執行本地身份驗證或授權檢查。在這種情況下，開發人員應該實施本地完整性檢查，以檢測任何未經授權的程式碼更改。請參考 M9 有關檢測和應對二進制攻擊的額外指南。

# 攻擊情境舉例

以下情境展示了行動應用程式中不安全的身份驗證或授權控制:

**情境1:** 隱藏的服務請求：開發人員假設只有驗證的使用者才能生成程式提交給後端進行處理的服務請求。在處理請求的過程中，伺服器程式碼未驗證傳入的請求是否與已知使用者相關聯。因此，攻擊者能夠提交服務請求到後端服務，匿名執行會影響到合法使用者的功能。

**情境2:** 介面依賴：開發人員假設只有經授權的使用者才能看到其應用程式上的特定功能。因此，他們期望只有合法經授權的使用者才能從其行動裝置發出對服務的請求。處理請求的後端程式碼未驗證與請求相關聯的身份是否有權執行服務。因此，攻擊者能夠使用相當低權限的使用者帳戶執行遠程管理功能。

**情境3:** 可用性要求：由於可用性要求，行動應用程式允許使用4位數字的密碼。伺服器程式碼正確地儲存密碼的雜湊版本。然而，由於密碼的長度極短，攻擊者將能夠透過彩虹表迅速推斷出原始密碼。如果伺服器上的密碼文件（或數據存儲）受到威脅，攻擊者將能夠快速推斷出使用者的密碼。

# 參考資料

- OWASP
  - [OWASP](https://www.owasp.org/index.php/OWASP_Top_Ten)
- External
  - [External References](http://cwe.mitre.org/)