---

layout: col-sidebar
title: "M5: 不當的加密法"
---

# 威脅主體

**應用層面 特定**

威脅主體包括以下兩種情境：任何具有物理訪問加密不當的數據的人，或者替攻擊者行事的行動惡意軟體。

# 攻擊媒介	

**利用難度 簡單**

此攻擊媒介與傳統OWASP十大中的攻擊媒介相同。在這裡任何公開的API呼叫都有可能成為攻擊媒介。

# 安全層面的強度	

**普及性 常見** <br />
**偵測性 平均**

要利用這個弱點，攻擊者必須成功地將因弱加密演算法或加密過程中的缺陷而返回的加密程式碼或敏感數據還原為其原始的未加密形式。 

# 技術性影響		

**影響程度 嚴重**

這個弱點能夠在行動裝置中未經授權地檢索敏感信息。

# 業務影響
	
**應用程式/業務 特定** 

這個弱點可能對業務產生多種不同的影響。通常，殘缺的加密可能導致以下情況:

- 隱私侵犯;
- 信息盜竊;
- 程式碼盜竊;
- 智慧財產被盜竊; 
- 聲譽損害

# 我是否容易受到「不當的加密法」的攻擊?

不安全使用加密法在大多數利用加密的行動應用程式中都很普遍。在行動應用程式中，破碎的加密主要表現為兩種基本方式。首先，行動應用程式可能使用在加密/解密過程中有根本上缺陷並可被攻擊者利用以解密敏感數據。其次，行動應用程式可能實施或利用本質上薄弱且可以被攻擊者直接解密的加密/解密演算法。以下子節探討這兩種情境更深入的細節：

## 依賴內建程式碼加密流程

預設情況下，iOS 應用程式通過程式碼加密以防止逆向工程（理論上）。iOS 安全模型要求應用程式在非越獄環境中必須由可信任的來源進行加密和簽名才能執行。在啟動時，iOS 應用程式載入器將在內存中解密應用程式，並在 iOS 驗證其簽名後繼續執行程式碼。這項功能理論上能防止攻擊者對 iOS 行動應用程式進行二進制攻擊。

使用像 ClutchMod 或 GBD 這樣的免費工具，攻擊者將加密的應用程式下載到他們的越獄裝置上，並在 iOS 載入器將其加載到內存並解密（就在載入器啟動執行之前）時拍攝解密的應用程式的快照。一旦對手拍攝快照並將其存儲在磁盤上，對手可以使用像 IDA Pro 或 Hopper 這樣的工具輕鬆進行應用程式的靜態/動態分析並進行進一步的二進制攻擊。

規避內建程式碼的加密演算法是微不足道的。始終要假設攻擊者將能夠繞過底層行動作業系統提供的任何內建程式碼加密。有關採取額外的逆向工程防護層的更多信息，請參見 M9。

**不良的金鑰管理流程**

即使是最好的演算法在處理金鑰時不當就毫無用處。很多人犯了使用正確的加密演算法卻執行自定義的協定的錯誤。一些問題例子包括:

- 在加密內容的同一個可被攻擊者讀取的目錄中包含金鑰;
- 將金鑰以其他方式提供給攻擊者;
- 避免在二進制中使用硬編碼的金鑰;
- 金鑰可能會通過二進制攻擊被攔截。有關防止二進制攻擊的更多信息，請參見 M10。

**創建和使用自定義加密協定**

在處理加密時，無論是行動還是其他情境，都沒有比創建和使用自己的加密算法或協定更容易搞砸的方法。

始終使用由安全社群認可為強大的現代演算法，並在可能的情況下充分利用您的行動平台中的最新加密 API。二進制攻擊可能會導致對手識別您在二進制中使用的常見函式庫以及其中的任何硬編碼金鑰。在加密要求非常高的情況下，應強烈考慮使用白盒密碼學。有關防止對常見函式庫進行利用的二進制攻擊的更多信息，請參見 M10。

**使用不安全和/或已棄用的演算法**

許多加密算法和協定不應使用，因為它們已被證明存在顯著的弱點，或者對於現代安全要求來說不足夠。這些包括:

- RC2
- MD4
- MD5
- SHA1

# 如何防止「不當的加密法」?

在處理敏感數據時，最好採取以下措施:

- 在可能的情況下，避免在行動裝置上存儲任何敏感數據。
- 採用將能夠在未來至少10年內經得住考驗的加密標準;
- 遵循NIST（美國國家標準與技術研究院）對推薦演算法的指南（參見參考資料）。

# 攻擊情境舉例

無

# 參考資料
- OWASP
  - [OWASP Cryptographic Storage Cheat Sheet](https://www.owasp.org/index.php/Cryptographic_Storage_Cheat_Sheet)
  - [OWASP Key Management Cheat Sheet](https://www.owasp.org/index.php/Key_Management_Cheat_Sheet)
- External
  - [NIST Encryption Guidelines](http://csrc.nist.gov/publications/drafts/800-175/sp800-175b_draft.pdf)