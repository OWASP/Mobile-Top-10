---

layout: col-sidebar
title: "M4: 不足的輸入/輸出合法性檢查"
---

# 威脅主體

**應用層面 特定**

對外部來源數據（例如用戶輸入或網絡數據）不足的驗證和清理，對於行動應用程式而言會引入嚴重的安全漏洞。未能正確驗證和清理這類數據的行動應用程式可能面臨特定於移動環境的攻擊，包括SQL注入、命令注入和跨站腳本（XSS）攻擊。

這些漏洞可能帶來嚴重後果，包括未經授權訪問敏感數據、操縱應用程式功能，以及潛在地危及整個移動系統的風險。

不足的輸出驗證可能導致數據損壞或呈現漏洞，使惡意攻擊者能夠注入惡意程式碼或操縱對用戶顯示的敏感信息。

# 攻擊媒介

**利用難度 困難**

不足的輸入/輸出合法性檢查使我們的應用程式容易受到嚴重的攻擊，包括SQL注入、跨站腳本（XSS）、命令注入和路徑遍歷。這些漏洞可能導致未經授權的訪問、數據操縱、程式碼執行，以及對整個後端系統的危害。

# 安全層面的強度	

**普及性 常見**

**偵測性 簡單**

不足的輸入/輸出驗證漏洞發生在應用程式未能正確檢查和清理用戶輸入或驗證和清理輸出數據的情況。這種漏洞可以通過以下方式被利用：

**不足的輸入合法性檢查：** 當未充分檢查用戶輸入時，攻擊者可以通過輸入未預期或惡意的數據來操縱它。這可能規避安全措施，導致程式碼執行漏洞或未經授權的系統訪問。

**不足的輸出合法性檢查：** 如果輸出的數據未經適當驗證和清理，攻擊者可以注入惡意腳本，由用戶的瀏覽器執行。這可能導致跨站腳本（XSS）攻擊，啟用數據竊取、會話劫持或操縱顯示的內容。

**缺乏背景合法性檢查：** 未考慮特定背景或預期的數據格式會導致SQL注入或格式字符串漏洞等漏洞。當未經驗證的用戶輸入直接納入數據庫查詢或在格式字符串函數中未被正確處理時，攻擊者可以操縱查詢或執行任意程式碼。

**未驗證數據完整性：** 如果不驗證數據完整性，應用程式就容易受到數據損壞或處理不正確的影響。攻擊者可以篡改關鍵系統變數或引入格式不正確的數據，破壞應用程式的功能。

這些漏洞通常源於應用程式邏輯中的錯誤、合法性檢查實施不完全、安全意識不足，或測試和程式碼審查實踐不足。 

# 技術性影響

**影響程度 嚴重**


不足的輸入/輸出驗證漏洞對受影響的應用程式可能產生多個技術影響：

**程式碼執行:** 惡意攻擊者可以利用此漏洞在應用程式的環境中執行未經授權的代碼，規避安全措施。

**數據泄露:** 不足的驗證可能使攻擊者能夠操縱輸入，潛在地導致未經授權的訪問並提取敏感數據。

**系統被駭:** 攻擊者可以未經授權地訪問底層系統，駭入系統並掌控它。

**應用程式中斷:** 惡意輸入可能導致中斷、崩潰或數據損壞，影響應用程式的可靠性和功能。

**名譽損害:** 成功利用此漏洞可能導致因數據泄露和客戶信任損失而受到名譽損害。

**法律和合規問題:** 不足的驗證可能導致法律責任、法規罰款以及違反數據保護法規。


# 業務影響
	
**影響程度 嚴重**

不足的輸入/輸出驗證漏洞對技術和業務方面都有嚴重影響。從應用程式的角度來看，其影響包括：

- 程式碼執行：攻擊者可以利用此漏洞執行未經授權的程式碼，可能導致系統被駭和未經授權的訪問。
- 數據泄露：不足的驗證使攻擊者能夠操縱輸入，導致數據泄露和對敏感信息的未經授權訪問。
- 系統中斷：漏洞的利用可能導致應用程式崩潰、不穩定或數據損壞，引起服務中斷和運營效率降低。
- 數據完整性問題：不足的驗證可能導致數據損壞、處理不正確或輸出不準確，損害系統的可靠性和完整性。

在業務方面，這些影響包括:
- 名譽損害： 漏洞成功被利用可能導致數據泄露、系統中斷和客戶不信任，損害組織的名譽和品牌形象。
- 法律和合規後果： 由於驗證不足導致違反數據保護法規，可能引起法律責任、法規罰款和潛在的財務損失。
- 財務影響： 由漏洞引起的數據泄露或系統中斷可能導致因意外響應、修復成本、法律費用和潛在的收入損失而導致的財務損失。

# 我是否容易受到「不足的輸入或輸出合法性檢查」的攻擊？

應用程式可能因以下原因而容易受到不足的輸入/輸出驗證漏洞的影響：

- 缺少輸入驗證： 未能正確驗證用戶輸入可能使應用程式容易受到注入攻擊的影響，如SQL注入、命令注入或跨站腳本（XSS）攻擊。
- 輸出數據清理不足： 輸出數據的不足清理可能導致XSS漏洞，使攻擊者能夠注入並執行惡意腳本。
- 忽略特定背景驗證： 沒有考慮特定背景的要求可能導致漏洞，例如路徑尋訪攻擊或對文件的未經授權訪問。
- 數據完整性檢查不足： 不進行適當的數據完整性檢查可能導致數據損壞或未經授權的修改，從而損害可靠性和安全性。
- 不佳的安全編碼實踐： 忽略安全編碼實踐，例如使用參數化查詢或進行跳脫(escaping)/加密數據，導致輸入/輸出驗證漏洞。


# 如何避免「不足的輸入或輸出合法性檢查」?

避免「不足的輸入或輸出合法性檢查」:
- 輸入驗證:
  - 用嚴格的驗證技術對用戶輸入進行驗證和清理
  - 實施輸入長度限制，拒絕未預期或惡意數據。
- 輸出清理:
  - 正確清理輸出數據，以防止跨站腳本（XSS）攻擊。
  - 在顯示或傳輸數據時使用輸出加密技術。
- 特定背景驗證:
  - 根據數據背景執行特定的驗證（例如，文件上傳、數據庫查詢），以防止路徑尋訪或注入等攻擊。
- 數據完整性檢查:
  - 實施數據完整性檢查，檢測並防止數據損壞或未經授權的修改。
- 安全編碼實踐:
  - 遵從安全編碼實踐，例如使用參數化查詢和預先處理的宣告，以防止SQL注入。
- 定期安全測試:
  - 定期進行安全評估，包括滲透測試和代碼審查，以識別和解決潛在的漏洞。
 
# 攻擊情境舉例

**情境1** 通過惡意輸入執行遠端程式碼

攻擊者識別到一個缺乏正確地執行輸入驗證和清理的行動應用程式。通過製造包含意外字符的惡意輸入，他們利用應用程式行為的漏洞。由於驗證不足，應用程式處理輸入時出現問題，導致漏洞。攻擊者成功執行任意代碼，未經授權地訪問裝置的資源和敏感數據。

**情境2** 通過不足的輸出驗證執行注入攻擊

An attacker identifies a mobile application with inadequate output validation and sanitization. They exploit an entry point where user-generated content or untrusted data is processed. By crafting malicious input containing code or scripts (e.g., HTML, JavaScript, SQL), the attacker takes advantage of the lack of output validation. Submitting the crafted input through user interaction, the application fails to validate or sanitize it, allowing the execution of injected code or unintended operations. The attacker successfully executes injection-based attacks like cross-site scripting (XSS) or SQL injection, compromising the application's integrity and gaining access to sensitive information.攻擊者識別到一個輸出驗證和清理不足的行動應用程式。他們利用一個處理使用者生成內容或處理不受信任數據的入口點。通過製作包含程式碼或腳本（例如HTML、JavaScript、SQL）的惡意輸入，攻擊者利用缺乏輸出驗證的情況。透過與使用者互動來送出製作的輸入，應用程式未能對其進行驗證或清理，從而允許執行注入程式碼或非預期操作。攻擊者成功執行透過注入的攻擊，如跨站腳本（XSS）或SQL注入，危害應用程式的完整性並獲取對敏感信息的訪問權限。

**情境3** 通過錯誤格式輸出執行遠端程式碼

攻擊者識別到一個處理用戶提供數據並生成動態輸出的移動應用程式。攻擊者製作特別格式的數據，以利用應用程式不足的輸出驗證。攻擊者將錯誤格式的數據提交給應用程式，可以是通過直接互動或利用公開的API。
應用程式未能正確驗證或清理生成的輸出，允許攻擊者製作的數據執行程式碼或觸發非預期的操作。
通過利用這個漏洞，攻擊者實現了遠端程式碼執行，獲得對行動裝置、其資源或敏感數據的控制

# 參考資料

- OWASP
  - [Input Validation Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html)
  - [Improper Data Validation](https://owasp.org/www-community/vulnerabilities/Improper_Data_Validation#:~:text=Omitting%20validation%20for%20even%20a,incomplete%20or%20absent%20input%20validation.)

- External
  - [External References](http://cwe.mitre.org/)
  - [Improper Input Validation](https://cwe.mitre.org/data/definitions/20.html)



