---

layout: col-sidebar
title: "M10: 不當的加密法"
---

# 威脅主體

**應用層面 特定**

利用行動應用程式中不安全的加密的威脅主體可以破壞敏感信息的保密性、完整性和真實性。這些威脅主體包括針對加密算法或實踐進行攻擊以解密敏感數據的攻擊者，操縱加密過程或洩漏加密密鑰的惡意內部人員，從事為情報目的而進行密碼分析的國家支持的行為者，利用弱加密進行盜竊有價值的數據或進行金融欺詐的網絡罪犯，以及利用加密協議或函式庫中的漏洞的攻擊者。

# 攻擊媒介

**利用難度 平均**

在行動應用程式中，不安全的加密的攻擊媒介涉及利用用於保護敏感信息的加密機制中的漏洞。攻擊者可能使用各種技術，如加密攻擊、暴力攻擊或側信道攻擊，來利用加密算法、密鑰管理或實踐錯誤中的弱點。通過針對不安全的加密，攻擊者的目標是解密加密數據、操縱加密過程或未經授權地訪問敏感信息。這可能導致數據泄露、對用戶帳戶的未經授權訪問、保密性受損，或有能力進行數據的偽造或篡改。

# 安全層面的強度

**普及性 常見**

**偵測性 平均**

行動應用程式中的不安全加密引入了安全弱點，可能破壞加密措施的有效性，危害敏感數據的機密性和完整性。這些弱點可能包括使用弱加密算法或不足夠的密鑰長度、不良的密鑰管理實踐、不當處理加密密鑰、不安全的隨機數生成、加密協議的缺陷實行，或者是加密函式庫或框架中的漏洞。攻擊者可以利用這些弱點來規避加密、進行加密攻擊、操縱數據，或未經授權地訪問加密信息。在行動應用程式中，不安全的雜湊函數和加密算法構成了嚴重的安全弱點。這些漏洞可能導致嚴重的數據泄露和對敏感信息的未經授權訪問。當使用過時或脆弱的雜湊函數時，攻擊者可以利用這些缺陷對雜湊數據進行逆向工程，揭露原始內容。為了保護行動應用程式免受這些安全風險的影響，採用強大且現代的雜湊函數和加密算法至關重要，同時遵循加密和密鑰管理的最佳實踐，以確保數據的完整性和機密性。定期的安全審核和更新也是維持最高保護水平的關鍵。

# 技術性影響

**影響程度 嚴重**

這個漏洞將導致未經授權地從行動裝置檢索敏感信息。

# 業務影響

**影響程度 嚴重**

行動應用程式中的加密不足或不安全的雜湊函數可能對業務產生重大影響。以下是一些可能的後果:

**數據洩露**: 脆弱或不足的加密法可能使攻擊者更容易侵犯行動應用程式存儲或傳輸的敏感數據的保密性。這可能導致數據泄露，從而暴露出敏感的客戶信息，如個人可識別信息（PII）、財務細節或智慧財產權。這樣的泄露可能導致法律責任、監管罰款、客戶信任損失和聲譽損害。

**智慧財產權損失**: 不當的加密法可能危及行動應用程式中嵌入的專有算法、商業機密或其他智慧財產權的保護。如果攻擊者能夠解密並提取這些有價值的信息，它可以被競爭對手公司利用，或在黑市上出售。

**財務損失**: 加密不足可能以多種方式導致財務損失。例如，如果支付交易或財務數據未經適當加密，則可能使客戶面臨欺詐和未經授權訪問其資金的風險。此外，調查和修正安全漏洞、賠償受影響的客戶以及應對法律後果的成本可能是巨大的。

**合規和法律後果**: 許多行業都有特定的數據保護和隱私法規，要求對敏感信息使用強大的加密。不足的加密可能導致不符合這些法規，從而導致法律後果、監管機構處以的罰款或制裁。

# 我是否容易受到「不當的加密法」的攻擊?

在行動應用程式中，不安全的加密和不安全的雜湊函數可能以多種方式表現：

**脆弱加密演算法**: 行動應用程式可能使用已知為脆弱或容易受到攻擊的加密演算法。這些演算法可能存在已知的弱點，過時，或缺乏必要的安全性來有效保護敏感數據。

**不足的密鑰長度**: 不足的密鑰長度可能削弱加密強度。如果行動應用程式使用短或易猜測的加密金鑰，攻擊者可以更容易通過暴力破解或其他密碼攻擊解密加密數據。

**不當的密鑰管理**: 不良的密鑰管理實踐，例如不安全地存儲加密金鑰或以明文傳輸它們，可能導致密鑰被未經授權的訪問。獲取密鑰的攻擊者可以輕鬆解密數據。

**有缺陷的加密實行**: 加密/解密過程本身可能被不正確實行或包含程序錯誤。這些實行錯誤可能引入漏洞，攻擊者可以利用它們來規避或削弱加密保護。

**數據或加密密鑰的不安全存儲**:  如果加密密鑰在行動裝置上以不安全的方式存儲，例如以明文或在易於訪問的位置存儲，攻擊者可以在物理上或未經授權訪問裝置的情況下，檢索密鑰並解密受保護的數據。行動應用程式使用弱加密算法或不正確地使用加密，例如使用不牢固的金鑰或未正確加密所有敏感數據。如果加密易於被攻擊者規避或解密，這可能導致數據受損。

**缺乏安全的傳輸層**: 在網絡上傳輸加密數據時，使用安全的傳輸層協議（如HTTPS）至關重要。如果行動應用程式未實施安全的傳輸協議，則在傳輸過程中，加密數據可能容易被攔截或篡改。

**不足的驗證和身份驗證**: 不足的驗證和參與加密過程的身份驗證可能削弱整體安全性。缺乏適當的驗證，攻擊者可以冒充合法實體，攔截加密數據，並在不被察覺的情況下操縱數據。

**缺少鹽值(Salting)**: 鹽值是在雜湊之前將隨機數據添加到輸入的過程，對於增強密碼的安全性至關重要。不安全的雜湊函數可能不支持鹽值，或者可能使用脆弱的鹽值方法，使密碼雜湊容易受到攻擊，如預先計算的表或暴力破解攻擊。

# 如何防止「不當的加密法」攻擊？

為了防止行動應用程式中的"不當的加密法"弱點，需考慮以下最佳實踐:

**使用強大的加密算法**: 實施廣泛接受的安全加密演算法，如AES（高級加密標準），RSA（Rivest-Shamir-Adleman）或橢圓曲線加密（ECC）。保持對當前加密標準的了解，避免使用已廢棄或脆弱的演算法。

**確保足夠的密鑰長度**: 選擇具有適當長度的加密金鑰，以確保強大的加密強度。遵循密鑰長度的行業建議，考慮使用特定的加密演算法。

**遵循安全的密鑰管理實踐**: 使用安全的密鑰管理技術，例如使用金鑰保險庫或硬體安全模塊（HSM）來安全地存儲加密金鑰。保護金鑰免受未經授權的訪問，包括限制授權人員的訪問權限，使用静止加密，並使用安全的金鑰分發機制。

**正確實施加密**: 在行動應用程式中小心執行加密和解密過程，遵循已建立的加密函式庫和框架。避免使用自定義的加密實踐，因為它們更容易出現錯誤和弱點。

**安全存儲加密金鑰**: 確保加密金鑰在行動裝置上安全存儲。避免以明文或易於訪問的位置存儲金鑰。考慮使用操作系統提供的安全存儲機制或利用基於硬體的安全存儲選項。

**使用安全的傳輸層**: 在網絡上傳輸加密數據時，使用安全的傳輸層協議，如HTTPS（HTTP安全）。實施正確的憑證驗證，確保行動應用程式和後端系統之間的通信通道是安全的。

**驗證和身份驗證**: 實施強大的驗證和身份驗證機制，以驗證參與加密過程的各方的完整性和真實性。對用於身份驗證的憑證，數位簽名或其他機制進行正確的驗證。

**定期更新安全措施**: 了解來自加密函式庫、框架和平台提供商的安全更新、補丁和建議。保持行動應用程式和底層加密元件的最新狀態，以應對檢測到的任何弱點或漏洞。

**進行安全測試**: 執行全面的安全測試，包括加密漏洞評估、滲透測試和程式碼審查。在測試過程中發現的任何弱點或漏洞都要進行識別和修復。

**遵循行業標準和最佳實踐**: 保持對與加密有關的行業標準和最佳實踐的了解。像NIST（國家標準與技術研究所）和IETF（互聯網工程任務組）這樣的組織提供了有關安全加密實踐的指南和建議。

**使用強大的雜湊函數**: 選擇廣為認可和具有密碼學安全性的雜湊函數，如SHA-256或bcrypt。這些算法旨在抵抗攻擊，提供高水平的安全性。

**實施鹽值(salting)**: 在雜湊密碼時，總是使用強大的隨機鹽值。鹽值通過使攻擊者難以使用預先計算的表或彩虹表來破解密碼

**使用密鑰派生函數（KDFs）**: 對於密碼雜湊，請使用密鑰派生函數，例如PBKDF2、bcrypt或scrypt。這些函數專門設計用於安全地從密碼中派生密碼學金鑰，並提供額外的安全功能，如迭代次數，以減慢暴力攻擊的速度。

# 攻擊情境舉例

**情境1:** 中間人攻擊（MitM攻擊） - 攻擊者攔截行動應用程式與伺服器之間的通信。弱加密可能使攻擊者能夠解密截取的數據，修改它，並在轉發給預定的接收者之前重新加密。這可能導致未授權訪問，數據操縱或惡意內容的注入。

**情境2:** 暴力破解攻擊 - 攻擊者系統性地嘗試各種密鑰組合，直到找到正確的密鑰來解密數據。弱加密可能縮短此類攻擊所需的時間，可能暴露敏感信息。

**情境3:** 加密降級攻擊 - 行動應用程式可能支持多個加密協議或演算法以建立安全連接。如果作為備用選項的弱加密被允許，攻擊者可以利用此弱點，強制應用程式使用弱加密。最後，他們可以更輕鬆地解密截取的數據並發起後續攻擊。

**情境4:** 金鑰管理漏洞 - 不牢靠的金鑰管理做法可能削弱行動應用程式中使用的密碼學系統的安全性。例如，如果加密金鑰存儲不安全或容易猜測，攻擊者可以未經授權地訪問金鑰並解密加密的數據。這可能導致數據泄露和侵犯隱私。

**情境5:** 密碼學實現缺陷 - 脆弱的加密還可能源於行動應用程式本身的實踐缺陷。這些缺陷可能包括對密碼學函式庫的不正確使用，不安全的金鑰生成，不正確的隨機數生成或不安全的處理與加密相關的功能。攻擊者可以利用這些缺陷來規避或削弱加密保護。

# 參考資料

- OWASP
    - [OWASP](https://www.owasp.org/index.php/OWASP_Top_Ten)
- External
    - [External References](http://cwe.mitre.org/)

