---

layout: col-sidebar
title: "M7: 不足的二進制保護"
---

# 威脅主體

**應用層面 特定**

攻擊者對應用程式二進制檔案發動攻擊的原因有許多種。

這些二進制檔案可能包含有價值的機密信息，如商業 API 金鑰或硬編碼的加密密碼，攻擊者可能會濫用這些資訊。此外，二進制檔案中的程式碼本身也可能具有價值，例如因為它包含關鍵的業務邏輯或預先訓練的人工智慧模型。有些攻擊者可能不會直接針對應用程式本身，而是利用它來探測相對應的後端潛在弱點，為攻擊做準備。

除了收集資訊外，攻擊者還可能操控應用程式二進制檔案，以存取付費功能或規避其他安全檢查。在最糟糕的情況下，熱門的應用程式可能被修改以包含惡意程式碼，然後通過第三方應用程式商店或使用新名稱發布，以利用毫不知情的使用者。一個常見的攻擊例子是重新配置應用程式中的付款識別符，重新打包它，然後通過應用程式商店發布。當使用者從應用程式商店下載這個未經授權的副本時，是攻擊者而不是原本的開發商獲得支付款。

# 攻擊媒介	

**利用難度 簡單**

應用程式的二進制檔案通常可以從應用程式商店下載，或者從行動裝置複製，因此二進制攻擊很容易設置。

應用程式的二進制檔案可能會受到兩種類型的攻擊：

逆向工程：應用程式的二進制檔案被反編譯並掃描，以尋找有價值的資訊，如秘密金鑰、演算法或漏洞。

程式碼篡改：應用程式的二進制檔案被操控，例如，移除許可證檢查、規避付費牆或以使用者身份獲取其他利益。或者，應用程式的二進制檔案可能被操控以包含惡意程式碼。

# 安全層面的強度	

**普及性 常見**

**偵測性 簡單**

所有的應用程式都容易受到二進制攻擊的威脅，許多應用程式最終都可能成為某種形式的攻擊目標。那些在其二進制檔案中硬編碼了敏感數據或演算法的應用程式尤其容易受到二進制攻擊的威脅。這些應用程式應該採用防禦措施，足以抵擋潛在的攻擊者，使攻擊者放棄攻擊，因為突破保護的成本將比成功突破後的收益更高。在某些情況下，例如在防拷貝保護方面，只需延長破解過程直到應用銷售的目標收益達到即可。

一般來說，像 iOS 應用程式這樣的完全編譯的應用程式比 Android 應用程式中的高階字節碼更不容易受到逆向工程和程式碼篡改的影響（請注意，對於使用跨平台技術開發的應用程式，如 PWA 或 Flutter，這種情況可能不成立）。

特別是熱門的應用程式很可能會被操控並透過應用程式商店重新發布。可以由專門的公司提供檢測並移除這些被操控的副本，也可以透過應用程式本身的某些檢測和報告機制來實現。

請注意，沒有完全可靠的機制可以防止二進制攻擊。這是一場開發者在採取防禦措施方面，而攻擊者在打破這些措施方面，彼此不斷嘗試的較量。因此，每個應用程式都需要回答的問題是：應該投入多少努力來對抗二進制攻擊？


# 技術性影響

**影響程度 中等**

如前所述，二進制攻擊可能以逆向工程形式發生，從應用程式的二進制檔案中洩漏資訊，或以程式碼篡改形式發生，改變應用程式的運作方式。

如果機密資訊洩漏，就必須迅速在整個系統中替換這些資訊，如果這些機密資訊是硬編碼在應用程式中，這會變得困難。從二進制檔案中洩漏資訊還有可能揭露後端系統的安全漏洞。

然而，操控對系統的技術健全性影響更大。通過操控二進制檔案，攻擊者可以任意更改應用程式的運作方式，例如為了自己的利益或者對防禦此種有害請求不佳的後端進行干擾。

# 業務影響
	
**影響程度 中等**

商業 API 的金鑰或類似的機密資訊如果被大規模濫用，可能導致顯著的成本。同樣的情況也適用於被篡改來移除許可證檢查或以競爭對手之姿發佈其功能的應用程式。在這兩種情況下，破解應用程式或竊取 API 金鑰以進行個人使用的個體可能不太容易被發現。然而，在大規模的情況下，例如當 API 金鑰或功能被系統性地與其他應用程式一起使用時，惡意競爭者可能因成本顯著降低而獲得顯著優勢。

如果智慧財產權，例如經過精心開發的演算法或人工智慧模型，變得公開或被惡意競爭者竊取，應用程式開發者的商業模式可能受到更大威脅。

特別是熱門的應用程式如果被重新發布並附有惡意程式碼，可能導致嚴重的聲譽損害。即使應用程式提供者幾乎無法防止其應用程式被篡改副本並重新發布，負面的公眾關注可能會被導往原始提供者身上。因此，為了降低這種風險的發生機率，應該盡量讓攻擊者難以重新發布未經授權的副本。

# 我是否容易受到「不足的二進制保護」的攻擊？

所有的應用程式都容易受到二進制攻擊的威脅。如果應用程式的二進制檔案中包含敏感資料或硬編碼演算法，或者該應用程式非常受歡迎，那麼二進制攻擊可能變得特別有害。如果有額外的保護措施，如混淆、在本機程式碼中加密機密資訊（對於 Android 來說），成功的攻擊變得更加困難，但絕不是不可能的。

應用程式是否足夠安全取決於不同二進制攻擊可能對業務產生的影響。攻擊者的動機越強烈，影響越大，就應該投入越多的努力來保護。因此，對於二進制攻擊的「易受攻擊性」相當取決於特定應用程式的情況。

開發者可以使用與攻擊者類似的工具來檢查他們自己的應用程式二進制檔案，這是一個快速的檢查方法。有很多免費或價格合理的工具，如MobSF、otool、apktool和Ghidra，這些工具使用起來相當簡單，並且也有很好的文件紀錄。

# 如何避免「不足的二進制保護」？
 
對於每個應用程式，應該評估二進制檔案中是否包含任何關鍵內容，或者它的受熱門度是否需要進行二進制保護。如果是的話，可以透過威脅建模分析來辨識最高風險及其發生時預期的財務影響。對於最相關的風險，應採取相應的對策。

應用程式總是在不可信任的執行環境中運行，應僅獲取其運行所需的最少必要信息，因為這些信息始終有被洩漏或操控的風險。但是假設某些機密資訊、演算法、安全檢查等必須存在於應用程式的二進制檔案中，可以透過不同手段來抵禦不同的攻擊:

**逆向工程:** 為了防止逆向工程，應該讓應用程式二進制檔案變得難以理解。這可以通過許多免費和商業混淆工具來實現。在本機編譯部分應用程式（iOS 和 Android）或使用詮釋器或嵌套虛擬機器可以使逆向工程變得更加困難，因為許多反編譯工具只支援一種語言和二進制格式。這種混淆是程式碼複雜性和防禦逆向工程之間的權衡，因為許多依賴程式碼中特定字串或符號的函式庫在完全混淆的情況下可能無法正常運作。開發者可以使用前述工具檢查混淆的品質。

**破解安全機制:** 混淆也有助於防範操控，因為攻擊者必須理解控制流程以跳過安全檢查。此外，本地安全檢查應由後端強制執行。例如，受保護功能所需的資源應僅在本地和後端檢查都成功的情況下下載。最後，完整性檢查可以檢測到程式碼篡改並使應用程式安裝無法使用，例如通過刪除某些資源。然而，這種完整性檢查也可能像其他本地安全檢查一樣被找到並停用。

**重新發布** (帶有惡意程式碼): 完整性檢查，例如在啟動時進行的檢查，仍可以檢測到應用程式二進制檔案的重新發布和修改。這些違規可以自動報告，以便在它們變得普遍之前找到並從應用程式商店中刪除未經授權的副本。有一些專門的公司支援這種情況。


# 攻擊情境舉例

**情境1** 硬編碼API金鑰: 假設一個應用程式使用商業 API，每次呼叫都需要支付一小筆費用，而這些費用本應該由用戶支付的訂閱費用來支付。然而，用於訪問和計費的 API 金鑰卻是被硬編碼在應用程式的未受保護二進制程式碼中。攻擊者可以使用免費工具對應用程式進行逆向工程，並獲得訪問這個機密字符串的權限。由於 API 訪問僅受 API 金鑰的保護，而沒有額外的使用者身份驗證，攻擊者可以自由操作 API，甚至出售 API 金鑰。在最壞的情況下，API 金鑰可能會被大量濫用，給應用程式提供者帶來重大的財務損失，或者至少在 API 訪問被限速時阻礙合法用戶使用應用程式。

**情境2** 停用付款和許可證檢查: 一款手機遊戲可能會將應用程式和前幾個關卡免費發佈，如果用戶喜歡遊戲，則需要支付費用以獲得完整訪問權限。所有後續關卡的資源都隨應用程式一起發布，只受到許可檢查的保護，而該許可證是在用戶支付時下載的。攻擊者可以對應用程式進行逆向工程，試圖了解付款驗證是如何進行的。如果應用程式二進制檔案的保護不足，攻擊者很容易找到許可檢查並將其替換為靜態成功語句。然後，攻擊者可以重新編譯應用程式並免費遊玩，甚至在應用程式商店中以另一個名稱出售。

**情境3** 硬編碼AI模型: 假設一個醫療應用程式有一個 AI 模型，可以根據語音或自由文字輸入回答用戶的請求。為了實現離線訪問並避免託管自己的下載伺服器，該應用程式在其原始程式碼中包含了其專門的、經過品質保證的 AI 模型。這個 AI 模型是該應用程式最有價值的資產之一，花了多年的時間進行開發。攻擊者可能試圖從原始程式碼中提取這個模型並將其出售給競爭對手。如果應用程式的二進制檔案保護不足，攻擊者不僅可以訪問 AI 模型，還可以了解它的使用方式，將這些信息與 AI 訓練參數一同出售。


# 參考資料

- OWASP
  - [Tampering and Reverse Engineering (MASTG)](https://mas.owasp.org/MASTG/General/0x04c-Tampering-and-Reverse-Engineering/)
  - [Tampering and Reverse Engineering iOS (MASTG)](https://mas.owasp.org/MASTG/iOS/0x06c-Reverse-Engineering-and-Tampering/)
  - [Tampering and Reverse Engineering Android (MASTG)](https://mas.owasp.org/MASTG/Android/0x05c-Reverse-Engineering-and-Tampering/)
  - [OWASP Reverse Engineering and Code Modification Prevention Project](https://wiki.owasp.org/index.php/OWASP_Reverse_Engineering_and_Code_Modification_Prevention_Project)
  - [OWASP Top 10 for Large Language Models: LLM10: Model Theft](https://owasp.org/www-project-top-10-for-large-language-model-applications/)

- External
  - [External References](http://cwe.mitre.org/)
